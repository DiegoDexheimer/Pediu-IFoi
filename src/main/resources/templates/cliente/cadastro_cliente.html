<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Cadastro de Cliente | Pediu, IFoi</title>
		<link rel="icon" href="/favicon.ico" type="image/x-icon" />
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
			rel="stylesheet"        
		/>
	</head>
	<body class="bg-light">
		<div
			class="container min-vh-100 d-flex flex-column justify-content-center align-items-center"
		>
			<div class="w-100" style="max-width: 420px">
				<h1 class="mb-4 text-center fw-bold">Cadastro de Cliente</h1>
				<div th:if="${errors}" class="alert alert-danger">
					<strong>Dados inválidos:</strong>
					<ul>
						<li th:each="err : ${errors}" th:text="${err.defaultMessage}"></li>
					</ul>
				</div>
				<form action="/cliente/cadastro_cliente" method="post" id="cadastroForm" novalidate>
					<div class="mb-3">
						<label for="login" class="form-label">Login</label>
						<input
							type="text"
							class="form-control"
							id="login"
							name="login"
							required
							minlength="5"
							th:value="${cliente?.login}"
						/>
					</div>
					<div class="mb-3">
						<label for="senha" class="form-label">Senha</label>
						<input
							type="password"
							class="form-control"
							id="senha"
							name="senha"
							required
							minlength="5"
						/>
					</div>
					<div class="mb-3">
						<label for="nome" class="form-label">Nome</label>
						<input
							type="text"
							class="form-control"
							id="nome"
							name="nome"
							required
							minlength="3"
							th:value="${cliente?.nome}"
						/>
					</div>
					<div class="mb-3">
						<label for="telefone" class="form-label">Telefone</label>
						<div class="input-group">
							<input
								type="text"
								class="form-control"
								id="telefone"
								name="telefone"
								placeholder="(XX)XXXXX-XXXX"
								maxlength="12"
								th:value="${cliente?.telefone}"
								pattern="[0-9()\- ]"
								title="Digite exatamente 12 dígitos, apenas números e caracteres válidos do formato."
								oninput="this.value = this.value.replace(/[^0-9()\- ]/g, '')"
								required
							/>
						</div>
						<div id="telefoneHelp" class="form-text text-danger d-none">O telefone deve conter exatamente 12 dígitos numéricos.</div>
					</div>
					<button type="submit" class="btn btn-primary w-100" id="btnCadastrar" disabled>
						<i class="bi bi-person-plus"></i> Cadastrar
					</button>
				</form>
				<script src="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.js"></script>
				<script>
				const form = document.getElementById('cadastroForm');
				const btnCadastrar = document.getElementById('btnCadastrar');
				const telefoneInput = document.getElementById('telefone');
				const telefoneHelp = document.getElementById('telefoneHelp');

				function validarCampos() {
					const login = document.getElementById('login').value.trim();
					const senha = document.getElementById('senha').value.trim();
					const nome = document.getElementById('nome').value.trim();
					const telefone = telefoneInput.value.trim();
					const telefoneNumeros = telefone.replace(/[^0-9]/g, '');

					const loginValido = login.length >= 5;
					const senhaValida = senha.length >= 5;
					const nomeValido = nome.length >= 3;
					const telefoneValido = telefoneNumeros.length === 12;

					if (!telefoneValido && telefone.length > 0) {
						telefoneInput.classList.add('is-invalid');
						telefoneHelp.classList.remove('d-none');
					} else {
						telefoneInput.classList.remove('is-invalid');
						telefoneHelp.classList.add('d-none');
					}

					btnCadastrar.disabled = !(loginValido && senhaValida && nomeValido && telefoneValido);
				}

				form.addEventListener('input', validarCampos);
				window.addEventListener('DOMContentLoaded', validarCampos);
				</script>
			</div>
		</div>
	</body>
</html>
